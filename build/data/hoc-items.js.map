{"version":3,"names":["withSelect","withDispatch","dispatch","useEffect","useState","isObject","useLocation","AtrcGetQueryParams","withUrlChanged","WrappedComponent","props","_useState","_useState2","_slicedToArray","queryArgs","setQueryArgs","_props$atrcStore","atrcStore","_props$atrcStoreKey","atrcStoreKey","_props$refreshOnUrlCh","refreshOnUrlChange","React","createElement","currentPath","location","pathname","error","console","newQueryArgs","key","update","withSelectData","select","ownProps","_ownProps$atrcStore","_ownProps$atrcStoreKe","_ownProps$hiddenQuery","hiddenQueryArgsData","itemsData","getData","isLoading","canSave","items","countAllItems","countQueryItems","totalPages","item","selectedItems","confirmDelete","notices","updateData","extraData","getItem","id","withDispatchActions","_ownProps$atrcStore2","_ownProps$atrcStoreKe2","_ownProps$hiddenQuery2","args","arguments","length","undefined","toggleSelectAll","toggleSelect","setConfirmDelete","data","deleteItems","ids","updateItem","insertItem","setItem","updateItemData","val","dataKey","dataVal","setExtraData","setNotice","notice","setNotices","removeNotice","AtrcApplyWithItems","WithCombinedFunctionality"],"sources":["D:/wamp/www/atrc-package/atrc/packages/data/hoc-items.js"],"sourcesContent":["/*WordPress*/\r\nimport { withSelect, withDispatch, dispatch } from '@wordpress/data';\r\nimport { useEffect, useState } from '@wordpress/element';\r\n\r\n/* Library */\r\nimport { isObject } from 'lodash';\r\nimport { useLocation } from 'react-router-dom';\r\n\r\n/* Internal */\r\nimport { AtrcGetQueryParams } from './utils';\r\n\r\n/*Local*/\r\n\r\n// This HOC takes a component as an argument and returns a new component\r\nconst withUrlChanged = (WrappedComponent) => {\r\n\treturn (props) => {\r\n\t\tconst [queryArgs, setQueryArgs] = useState(null);\r\n\r\n\t\tconst {\r\n\t\t\tatrcStore = '',\r\n\t\t\tatrcStoreKey = '',\r\n\t\t\trefreshOnUrlChange = false,\r\n\t\t} = props;\r\n\r\n\t\tif (!refreshOnUrlChange) {\r\n\t\t\treturn <WrappedComponent {...props} />;\r\n\t\t}\r\n\r\n\t\tlet currentPath;\r\n\t\ttry {\r\n\t\t\t// Attempt to use useLocation()\r\n\t\t\tconst location = useLocation();\r\n\t\t\tcurrentPath = location.pathname;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Component is not inside a <Router>.', error);\r\n\t\t\treturn <WrappedComponent {...props} />;\r\n\t\t}\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tif (currentPath) {\r\n\t\t\t\tconst newQueryArgs = AtrcGetQueryParams(atrcStoreKey);\r\n\t\t\t\tsetQueryArgs(newQueryArgs);\r\n\t\t\t\tdispatch(atrcStore).setQueryArgs({\r\n\t\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\t\tqueryArgs: newQueryArgs,\r\n\t\t\t\t\tupdate: false,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t\t}, [currentPath]);\r\n\r\n\t\t/* queryArgs shoulbe be object either empty or not */\r\n\t\tif (null === queryArgs) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn <WrappedComponent {...props} />;\r\n\t};\r\n};\r\n\r\n// Creating the HOC using withSelect\r\nconst withSelectData = withSelect((select, ownProps) => {\r\n\tif (!ownProps || !ownProps.atrcStore || !ownProps.atrcStoreKey) {\r\n\t\treturn null;\r\n\t}\r\n\tconst {\r\n\t\tatrcStore = '',\r\n\t\tatrcStoreKey = '',\r\n\t\thiddenQueryArgsData = {},\r\n\t} = ownProps;\r\n\r\n\tlet queryArgs = AtrcGetQueryParams(atrcStoreKey);\r\n\r\n\t/* select called selectors */\r\n\tconst itemsData = select(atrcStore).getData(\r\n\t\tatrcStoreKey,\r\n\t\tqueryArgs,\r\n\t\thiddenQueryArgsData,\r\n\t\tatrcStore\r\n\t);\r\n\tlet isLoading = false;\r\n\tlet canSave = false;\r\n\tlet items = null;\r\n\tlet countAllItems = null;\r\n\tlet countQueryItems = null;\r\n\tlet totalPages = null;\r\n\tlet item = null;\r\n\tlet selectedItems = null;\r\n\tlet confirmDelete = null;\r\n\r\n\tlet notices = [];\r\n\tlet updateData = null;\r\n\tlet extraData = null;\r\n\r\n\tif (itemsData && isObject(itemsData)) {\r\n\t\t({\r\n\t\t\tisLoading,\r\n\t\t\tcanSave,\r\n\t\t\tqueryArgs,\r\n\t\t\titems,\r\n\t\t\tcountAllItems,\r\n\t\t\tcountQueryItems,\r\n\t\t\ttotalPages,\r\n\t\t\titem,\r\n\t\t\tselectedItems,\r\n\t\t\tconfirmDelete,\r\n\t\t\tnotices,\r\n\t\t\tupdateData,\r\n\t\t\textraData,\r\n\t\t} = itemsData);\r\n\t}\r\n\treturn {\r\n\t\tisLoading,\r\n\t\tcanSave,\r\n\t\tqueryArgs,\r\n\t\titems,\r\n\t\tcountAllItems,\r\n\t\tcountQueryItems,\r\n\t\ttotalPages,\r\n\t\titem,\r\n\t\tselectedItems,\r\n\t\tconfirmDelete,\r\n\t\tnotices,\r\n\t\tupdateData,\r\n\t\textraData,\r\n\t\tgetItem: (id) => select(atrcStore).getItem(atrcStoreKey, id, atrcStore),\r\n\t};\r\n});\r\n\r\n// Creating the HOC using withDispatch\r\n// eslint-disable-next-line no-shadow\r\nconst withDispatchActions = withDispatch((dispatch, ownProps) => {\r\n\tif (!ownProps || !ownProps.atrcStore || !ownProps.atrcStoreKey) {\r\n\t\treturn null;\r\n\t}\r\n\tconst {\r\n\t\tatrcStore = '',\r\n\t\tatrcStoreKey = '',\r\n\t\thiddenQueryArgsData = {},\r\n\t} = ownProps;\r\n\r\n\t/* dispatch called actions */\r\n\treturn {\r\n\t\tsetQueryArgs: (args = {}, update = true) =>\r\n\t\t\tdispatch(atrcStore).setQueryArgs({\r\n\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\tqueryArgs: args,\r\n\t\t\t\tupdate,\r\n\t\t\t\thiddenQueryArgsData,\r\n\t\t\t}),\r\n\t\ttoggleSelectAll: () =>\r\n\t\t\tdispatch(atrcStore).toggleSelectAll({ key: atrcStoreKey }),\r\n\t\ttoggleSelect: (item) =>\r\n\t\t\tdispatch(atrcStore).toggleSelect({ key: atrcStoreKey, item }),\r\n\t\tsetConfirmDelete: (data) =>\r\n\t\t\tdispatch(ownProps.atrcStore).setConfirmDelete({\r\n\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\tdata,\r\n\t\t\t}),\r\n\t\tdeleteItems: (ids) =>\r\n\t\t\tdispatch(ownProps.atrcStore).deleteItems({ key: atrcStoreKey, ids }),\r\n\t\tupdateItem: (item) =>\r\n\t\t\tdispatch(ownProps.atrcStore).updateItem({\r\n\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\tdata: item,\r\n\t\t\t}),\r\n\t\tinsertItem: (item) =>\r\n\t\t\tdispatch(ownProps.atrcStore).insertItem({\r\n\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\tdata: item,\r\n\t\t\t}),\r\n\t\tsetItem: (item) =>\r\n\t\t\tdispatch(ownProps.atrcStore).setItem({\r\n\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\tdata: item,\r\n\t\t\t}),\r\n\t\tupdateItemData: (key, val) =>\r\n\t\t\tdispatch(ownProps.atrcStore).updateItemData({\r\n\t\t\t\tkey: atrcStoreKey,\r\n\t\t\t\tdataKey: key,\r\n\t\t\t\tdataVal: val,\r\n\t\t\t}),\r\n\t\tsetExtraData: (data) =>\r\n\t\t\tdispatch(ownProps.atrcStore).setExtraData({ key: atrcStoreKey, data }),\r\n\t\tsetNotice: (notice) =>\r\n\t\t\tdispatch(ownProps.atrcStore).setNotice({ key: atrcStoreKey, notice }),\r\n\t\tsetNotices: (notices) =>\r\n\t\t\tdispatch(ownProps.atrcStore).setNotice({ key: atrcStoreKey, notices }),\r\n\t\tremoveNotice: (id) =>\r\n\t\t\tdispatch(ownProps.atrcStore).removeNotice({ key: atrcStoreKey, id }),\r\n\t};\r\n});\r\n\r\n// Combining both HOCs into a single HOC\r\nconst AtrcApplyWithItems = (WrappedComponent) => {\r\n\tconst WithCombinedFunctionality = withUrlChanged(\r\n\t\twithSelectData(withDispatchActions(WrappedComponent))\r\n\t);\r\n\treturn WithCombinedFunctionality;\r\n};\r\n\r\nexport default AtrcApplyWithItems;\r\n"],"mappings":"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"}