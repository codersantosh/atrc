{"version":3,"names":["React","__","useEffect","useState","useRef","useCallback","debounce","classnames","deepmerge","AtrcWrap","AtrcLabel","AtrcNotice","AtrcUseInstanceId","AtrcPrefix","AtrcPreTemplate1","AtrcPanelRow","EditorNotice","wp","codeEditor","createElement","isDismissible","CodeEditor","props","_props$label","label","_props$className","className","_props$variant","variant","_props$editorValue","editorValue","onChange","editorSettings","editorNotice","defaultProps","_objectWithoutProperties","_excluded","_useState","_useState2","_slicedToArray","value","setValue","_useState3","_useState4","codeMirror","setCodeMirror","instanceId","textareaRef","debouncedOnChange","val","leading","onChangeHandler","editor","getValue","target","current","_wp$codeEditor","defaultSettings","initialize","codeM","codemirror","on","_debouncedOnChange$cu","cancel","off","_extends","ref","id","AtrcControlCodeTextarea","_props$value","_props$onChange","_props$editorSettings","indentUnit","tabSize","mode","_props$editorNotice","_excluded2","_CodeEditor"],"sources":["D:/wamp/www/atrc-package/atrc/packages/controls/control-code-textarea/index.js"],"sourcesContent":["import React from 'react';\r\n\r\n/*Value Structure\r\nType string\r\n**/\r\n\r\n/*WordPress*/\r\nimport { __ } from '@wordpress/i18n';\r\n\r\nimport { useEffect, useState, useRef, useCallback } from '@wordpress/element';\r\n\r\nimport { debounce } from '@wordpress/compose';\r\n\r\n/*Library*/\r\nimport classnames from 'classnames';\r\n\r\nimport deepmerge from 'deepmerge';\r\n\r\n/*Atoms*/\r\nimport AtrcWrap from '../../atoms/wrap';\r\nimport AtrcLabel from '../../atoms/label';\r\n\r\n/* Molecules */\r\nimport AtrcNotice from '../../molecules/notice';\r\n\r\n/* Utils */\r\nimport AtrcUseInstanceId from '../../utils/use-instance-id';\r\n\r\n/*Prefix*/\r\nimport AtrcPrefix from '../../prefix-vars';\r\nimport AtrcPreTemplate1 from '../../templates/components/pre/template-1';\r\nimport AtrcPanelRow from './../../molecules/panel-row/index';\r\n\r\n/*Local*/\r\nconst EditorNotice = () => {\r\n\tif (typeof wp !== 'undefined' && wp.codeEditor) {\r\n\t\treturn null;\r\n\t}\r\n\treturn (\r\n\t\t<AtrcPanelRow>\r\n\t\t\t<AtrcNotice isDismissible={false}>\r\n\t\t\t\t{__('Add following scripts:', 'atrc-prefix-atrc')}\r\n\t\t\t\t<AtrcPreTemplate1>\r\n\t\t\t\t\twp_enqueue_code_editor( array( 'type' => 'text/css' ) );\r\n\t\t\t\t\twp_enqueue_script('wp-theme-plugin-editor');\r\n\t\t\t\t\twp_enqueue_style('wp-codemirror');\r\n\t\t\t\t</AtrcPreTemplate1>\r\n\t\t\t</AtrcNotice>\r\n\t\t</AtrcPanelRow>\r\n\t);\r\n};\r\n\r\nconst CodeEditor = (props) => {\r\n\tconst {\r\n\t\tlabel = '',\r\n\t\tclassName = '',\r\n\t\tvariant = '',\r\n\t\teditorValue = '',\r\n\t\tonChange,\r\n\t\teditorSettings,\r\n\t\teditorNotice,\r\n\t\t...defaultProps\r\n\t} = props;\r\n\r\n\tconst [value, setValue] = useState(editorValue);\r\n\tconst [codeMirror, setCodeMirror] = useState(null);\r\n\r\n\tconst instanceId = AtrcUseInstanceId(CodeEditor, 'control-code-textarea');\r\n\tconst textareaRef = useRef(null);\r\n\r\n\tconst debouncedOnChange = useRef(\r\n\t\tdebounce(\r\n\t\t\t(val) => {\r\n\t\t\t\tonChange(val);\r\n\t\t\t},\r\n\t\t\t500,\r\n\t\t\t{ leading: true }\r\n\t\t)\r\n\t);\r\n\r\n\tconst onChangeHandler = useCallback((editor) => {\r\n\t\tconst val = editor.getValue ? editor.getValue() : editor.target.value;\r\n\t\tsetValue(val);\r\n\t\tdebouncedOnChange.current(val);\r\n\t}, []);\r\n\r\n\t/* Initialize CodeMirror */\r\n\tuseEffect(() => {\r\n\t\tif (typeof wp !== 'undefined' && wp.codeEditor && textareaRef.current) {\r\n\t\t\tconst { defaultSettings, initialize } = wp.codeEditor;\r\n\r\n\t\t\tif (initialize) {\r\n\t\t\t\tconst codeM = initialize(\r\n\t\t\t\t\ttextareaRef.current,\r\n\t\t\t\t\tdeepmerge(defaultSettings, editorSettings)\r\n\t\t\t\t);\r\n\t\t\t\tsetCodeMirror(codeM);\r\n\t\t\t\tcodeM.codemirror.on('change', onChangeHandler);\r\n\t\t\t}\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tdebouncedOnChange?.current?.cancel();\r\n\t\t\t\tcodeMirror?.codemirror.off('change', onChangeHandler);\r\n\t\t\t};\r\n\t\t}\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<AtrcWrap\r\n\t\t\tclassName={classnames(\r\n\t\t\t\tAtrcPrefix('ctrl-code-txt-area'),\r\n\t\t\t\tclassName,\r\n\t\t\t\tvariant ? AtrcPrefix('ctrl-code-txt-area') + '-' + variant : ''\r\n\t\t\t)}\r\n\t\t\t{...defaultProps}>\r\n\t\t\t{label ? <AtrcLabel>{label}</AtrcLabel> : null}\r\n\t\t\t{editorNotice ? <EditorNotice /> : null}\r\n\t\t\t<AtrcPanelRow>\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tref={textareaRef}\r\n\t\t\t\t\tid={instanceId}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonChange={onChangeHandler}\r\n\t\t\t\t/>\r\n\t\t\t</AtrcPanelRow>\r\n\t\t</AtrcWrap>\r\n\t);\r\n};\r\n\r\nconst AtrcControlCodeTextarea = (props) => {\r\n\tconst {\r\n\t\tvalue = '',\r\n\t\tonChange = () => {},\r\n\t\teditorSettings = {\r\n\t\t\tindentUnit: 2,\r\n\t\t\ttabSize: 2,\r\n\t\t\tmode: 'css',\r\n\t\t},\r\n\t\teditorNotice = true,\r\n\t\t...defaultProps\r\n\t} = props;\r\n\r\n\treturn (\r\n\t\t<CodeEditor\r\n\t\t\teditorValue={value}\r\n\t\t\tonChange={onChange}\r\n\t\t\teditorSettings={editorSettings}\r\n\t\t\teditorNotice={editorNotice}\r\n\t\t\t{...defaultProps}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport default AtrcControlCodeTextarea;\r\n"],"mappings":"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","ignoreList":[]}