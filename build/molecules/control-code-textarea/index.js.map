{"version":3,"names":["__","sprintf","useEffect","useState","useMemo","useRef","useCallback","Fragment","useInstanceId","debounce","map","classnames","deepmerge","AtrcWrap","AtrcPanelTools","AtrcNotice","AtrcPrefix","CodeEditor","editorValue","onChange","editorSettings","value","setValue","codeMirror","setCodeMirror","instanceId","debouncedOnChange","val","leading","onChangeHandler","editor","getValue","current","wp","codeEditor","defaultSettings","initialize","codeM","codemirror","on","cancel","off","React","createElement","className","id","AtrcControlCodeTextarea","props","label","variant","notice","CodeTabs","name","title","hasValue","onDeselect","resetAll","tools","activeItems","tab","iDx","key","indentUnit","tabSize","mode","isDismissible","autoDismiss","status","dangerouslySetInnerHTML","__html"],"sources":["D:/wamp/www/atrc-package/atrc/packages/molecules/control-code-textarea/index.js"],"sourcesContent":["/*Value Structure\r\nType string\r\n**/\r\n\r\n/*WordPress*/\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\nimport {\r\n\tuseEffect,\r\n\tuseState,\r\n\tuseMemo,\r\n\tuseRef,\r\n\tuseCallback,\r\n\tFragment,\r\n} from '@wordpress/element';\r\n\r\nimport { useInstanceId, debounce } from '@wordpress/compose';\r\n\r\n/*Library*/\r\nimport { map } from 'lodash';\r\n\r\nimport classnames from 'classnames';\r\n\r\nimport deepmerge from 'deepmerge';\r\n\r\n/*Inbuilt*/\r\nimport AtrcWrap from '../../atoms/wrap';\r\n\r\nimport AtrcPanelTools from '../panel-tools';\r\nimport AtrcNotice from '../notice';\r\n\r\n/*Prefix*/\r\nimport AtrcPrefix from '../../prefix-vars';\r\n\r\n/*Local*/\r\nconst CodeEditor = ({ editorValue, onChange, editorSettings }) => {\r\n\tconst [value, setValue] = useState(editorValue);\r\n\tconst [codeMirror, setCodeMirror] = useState(null);\r\n\r\n\tconst instanceId = useInstanceId(CodeEditor, 'atrc-control-code-textarea');\r\n\r\n\tconst debouncedOnChange = useRef(\r\n\t\tdebounce(\r\n\t\t\t(val) => {\r\n\t\t\t\tonChange(val);\r\n\t\t\t},\r\n\t\t\t500,\r\n\t\t\t{ leading: true }\r\n\t\t)\r\n\t);\r\n\r\n\tconst onChangeHandler = useCallback((editor) => {\r\n\t\tconst val = editor.getValue ? editor.getValue() : editor;\r\n\t\tsetValue(val);\r\n\t\tdebouncedOnChange.current(val);\r\n\t}, []);\r\n\r\n\t/*Initialize CodeMirror*/\r\n\tuseEffect(() => {\r\n\t\tif (typeof wp !== 'undefined' && wp.codeEditor) {\r\n\t\t\tconst { defaultSettings, initialize } = wp.codeEditor;\r\n\r\n\t\t\tif (initialize) {\r\n\t\t\t\tconst codeM = initialize(\r\n\t\t\t\t\tinstanceId,\r\n\t\t\t\t\tdeepmerge(defaultSettings, editorSettings)\r\n\t\t\t\t);\r\n\t\t\t\tsetCodeMirror(codeM);\r\n\t\t\t\tcodeM.codemirror.on('change', onChangeHandler);\r\n\t\t\t}\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tdebouncedOnChange?.current?.cancel();\r\n\t\t\t\tcodeMirror?.codemirror.off('change', onChangeHandler);\r\n\t\t\t};\r\n\t\t}\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<textarea\r\n\t\t\tclassName={classnames(AtrcPrefix('control-code-textarea'))}\r\n\t\t\tid={instanceId}\r\n\t\t\tvalue={value}\r\n\t\t\tonChange={onChangeHandler}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nconst AtrcControlCodeTextarea = (props) => {\r\n\tconst {\r\n\t\tvalue = '',\r\n\t\tlabel = '',\r\n\t\tonChange = () => {},\r\n\t\tvariant = '',\r\n\t\tclassName = '',\r\n\t\tnotice = true,\r\n\t} = props;\r\n\r\n\tconst CodeTabs = useMemo(() => {\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tname: 'code',\r\n\t\t\t\ttitle: label,\r\n\t\t\t\thasValue: !!value,\r\n\t\t\t\tonDeselect: () => onChange(''),\r\n\t\t\t},\r\n\t\t];\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<AtrcPanelTools\r\n\t\t\tclassName={classnames(\r\n\t\t\t\tAtrcPrefix('ctrl-code-txt-area'),\r\n\t\t\t\tclassName,\r\n\t\t\t\tvariant ? AtrcPrefix('ctrl-code-txt-area') + '-' + variant : ''\r\n\t\t\t)}\r\n\t\t\tlabel={label}\r\n\t\t\tresetAll={() => onChange('')}\r\n\t\t\ttools={CodeTabs}>\r\n\t\t\t{(activeItems) =>\r\n\t\t\t\tmap(activeItems, (tab, iDx) => (\r\n\t\t\t\t\t<Fragment key={iDx}>\r\n\t\t\t\t\t\t<CodeEditor\r\n\t\t\t\t\t\t\teditorValue={value}\r\n\t\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t\t\teditorSettings={{\r\n\t\t\t\t\t\t\t\tindentUnit: 2,\r\n\t\t\t\t\t\t\t\ttabSize: 2,\r\n\t\t\t\t\t\t\t\tmode: 'css',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{notice && (\r\n\t\t\t\t\t\t\t<AtrcNotice\r\n\t\t\t\t\t\t\t\tisDismissible={false}\r\n\t\t\t\t\t\t\t\tautoDismiss={false}\r\n\t\t\t\t\t\t\t\tstatus='info'>\r\n\t\t\t\t\t\t\t\t<AtrcWrap\r\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\r\n\t\t\t\t\t\t\t\t\t\t__html: sprintf(\r\n\t\t\t\t\t\t\t\t\t\t\t// translators: %1$s: placeholder for code block, %2$s: placeholder for code with {{abBlock}}, %3$s: placeholder for code with ab-unique-class\r\n\t\t\t\t\t\t\t\t\t\t\t__(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'You can use the unique selector of the block using %1$s. eg: %2$s will be replaced with %3$s.',\r\n\t\t\t\t\t\t\t\t\t\t\t\t'atrc-prefix-atrc'\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>{{abBlock}}</code>',\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>{{abBlock}}{color:yellow}</code><br />',\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>.ab-unique-class{color:yellow}</code>'\r\n\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</AtrcNotice>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Fragment>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</AtrcPanelTools>\r\n\t);\r\n};\r\nexport default AtrcControlCodeTextarea;\r\n"],"mappings":"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"}