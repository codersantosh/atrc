{"version":3,"names":["__","sprintf","useEffect","useState","useMemo","useRef","useCallback","Fragment","debounce","map","random","classnames","deepmerge","AtrcWrap","AtrcPanelTools","AtrcNotice","AtrcPrefix","AtrcUniqueID","CodeEditor","_ref","editorValue","onChange","editorSettings","_useState","_useState2","_slicedToArray","value","setValue","_useState3","_useState4","codeMirror","setCodeMirror","instanceId","debouncedOnChange","val","leading","onChangeHandler","editor","getValue","current","wp","codeEditor","_wp$codeEditor","defaultSettings","initialize","codeM","codemirror","on","_debouncedOnChange$cu","cancel","off","React","createElement","className","id","AtrcControlCodeTextarea","props","_props$value","_props$label","label","_props$onChange","_props$variant","variant","_props$className","_props$notice","notice","CodeTabs","name","title","hasValue","onDeselect","resetAll","tools","activeItems","tab","iDx","key","indentUnit","tabSize","mode","isDismissible","autoDismiss","status","dangerouslySetInnerHTML","__html"],"sources":["D:/wamp/www/atrc-package/atrc/packages/molecules/control-code-textarea/index.js"],"sourcesContent":["/*Value Structure\r\nType string\r\n**/\r\n\r\n/*WordPress*/\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\nimport {\r\n\tuseEffect,\r\n\tuseState,\r\n\tuseMemo,\r\n\tuseRef,\r\n\tuseCallback,\r\n\tFragment,\r\n} from '@wordpress/element';\r\n\r\nimport { debounce } from '@wordpress/compose';\r\n\r\n/*Library*/\r\nimport { map, random } from 'lodash';\r\n\r\nimport classnames from 'classnames';\r\n\r\nimport deepmerge from 'deepmerge';\r\n\r\n/*Inbuilt*/\r\nimport AtrcWrap from '../../atoms/wrap';\r\n\r\nimport AtrcPanelTools from '../panel-tools';\r\nimport AtrcNotice from '../notice';\r\n\r\n/*Prefix*/\r\nimport AtrcPrefix from '../../prefix-vars';\r\nimport AtrcUniqueID from './../../utils/unique-id';\r\n\r\n/*Local*/\r\nconst CodeEditor = ({ editorValue, onChange, editorSettings }) => {\r\n\tconst [value, setValue] = useState(editorValue);\r\n\tconst [codeMirror, setCodeMirror] = useState(null);\r\n\r\n\tconst instanceId = AtrcUniqueID() + random(0, 9);\r\n\r\n\tconst debouncedOnChange = useRef(\r\n\t\tdebounce(\r\n\t\t\t(val) => {\r\n\t\t\t\tonChange(val);\r\n\t\t\t},\r\n\t\t\t500,\r\n\t\t\t{ leading: true }\r\n\t\t)\r\n\t);\r\n\r\n\tconst onChangeHandler = useCallback((editor) => {\r\n\t\tconst val = editor.getValue ? editor.getValue() : editor;\r\n\t\tsetValue(val);\r\n\t\tdebouncedOnChange.current(val);\r\n\t}, []);\r\n\r\n\t/*Initialize CodeMirror*/\r\n\tuseEffect(() => {\r\n\t\tif (typeof wp !== 'undefined' && wp.codeEditor) {\r\n\t\t\tconst { defaultSettings, initialize } = wp.codeEditor;\r\n\r\n\t\t\tif (initialize) {\r\n\t\t\t\tconst codeM = initialize(\r\n\t\t\t\t\tinstanceId,\r\n\t\t\t\t\tdeepmerge(defaultSettings, editorSettings)\r\n\t\t\t\t);\r\n\t\t\t\tsetCodeMirror(codeM);\r\n\t\t\t\tcodeM.codemirror.on('change', onChangeHandler);\r\n\t\t\t}\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tdebouncedOnChange?.current?.cancel();\r\n\t\t\t\tcodeMirror?.codemirror.off('change', onChangeHandler);\r\n\t\t\t};\r\n\t\t}\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<textarea\r\n\t\t\tclassName={classnames(AtrcPrefix('control-code-textarea'))}\r\n\t\t\tid={instanceId}\r\n\t\t\tvalue={value}\r\n\t\t\tonChange={onChangeHandler}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nconst AtrcControlCodeTextarea = (props) => {\r\n\tconst {\r\n\t\tvalue = '',\r\n\t\tlabel = '',\r\n\t\tonChange = () => {},\r\n\t\tvariant = '',\r\n\t\tclassName = '',\r\n\t\tnotice = true,\r\n\t} = props;\r\n\r\n\tconst CodeTabs = useMemo(() => {\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tname: 'code',\r\n\t\t\t\ttitle: label,\r\n\t\t\t\thasValue: !!value,\r\n\t\t\t\tonDeselect: () => onChange(''),\r\n\t\t\t},\r\n\t\t];\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<AtrcPanelTools\r\n\t\t\tclassName={classnames(\r\n\t\t\t\tAtrcPrefix('ctrl-code-txt-area'),\r\n\t\t\t\tclassName,\r\n\t\t\t\tvariant ? AtrcPrefix('ctrl-code-txt-area') + '-' + variant : ''\r\n\t\t\t)}\r\n\t\t\tlabel={label}\r\n\t\t\tresetAll={() => onChange('')}\r\n\t\t\ttools={CodeTabs}>\r\n\t\t\t{(activeItems) =>\r\n\t\t\t\tmap(activeItems, (tab, iDx) => (\r\n\t\t\t\t\t<Fragment key={iDx}>\r\n\t\t\t\t\t\t<CodeEditor\r\n\t\t\t\t\t\t\teditorValue={value}\r\n\t\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t\t\teditorSettings={{\r\n\t\t\t\t\t\t\t\tindentUnit: 2,\r\n\t\t\t\t\t\t\t\ttabSize: 2,\r\n\t\t\t\t\t\t\t\tmode: 'css',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{notice && (\r\n\t\t\t\t\t\t\t<AtrcNotice\r\n\t\t\t\t\t\t\t\tisDismissible={false}\r\n\t\t\t\t\t\t\t\tautoDismiss={false}\r\n\t\t\t\t\t\t\t\tstatus='info'>\r\n\t\t\t\t\t\t\t\t<AtrcWrap\r\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\r\n\t\t\t\t\t\t\t\t\t\t__html: sprintf(\r\n\t\t\t\t\t\t\t\t\t\t\t// translators: %1$s: placeholder for code block, %2$s: placeholder for code with {{abBlock}}, %3$s: placeholder for code with ab-unique-class\r\n\t\t\t\t\t\t\t\t\t\t\t__(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'You can use the unique selector of the block using %1$s. eg: %2$s will be replaced with %3$s.',\r\n\t\t\t\t\t\t\t\t\t\t\t\t'atrc-prefix-atrc'\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>{{abBlock}}</code>',\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>{{abBlock}}{color:yellow}</code><br />',\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>.ab-unique-class{color:yellow}</code>'\r\n\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</AtrcNotice>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Fragment>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</AtrcPanelTools>\r\n\t);\r\n};\r\nexport default AtrcControlCodeTextarea;\r\n"],"mappings":"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"}