{"version":3,"names":["_i18n","require","_element","_compose","_lodash","_classnames","_interopRequireDefault","_deepmerge","_wrap","_panelTools","_notice","_prefixVars","obj","__esModule","default","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","len","length","arr2","r","l","t","Symbol","iterator","e","u","a","f","next","done","push","value","return","isArray","CodeEditor","_ref","editorValue","onChange","editorSettings","_useState","useState","_useState2","setValue","_useState3","_useState4","codeMirror","setCodeMirror","instanceId","useInstanceId","debouncedOnChange","useRef","debounce","val","leading","onChangeHandler","useCallback","editor","getValue","current","useEffect","wp","codeEditor","_wp$codeEditor","defaultSettings","initialize","codeM","deepmerge","codemirror","on","_debouncedOnChange$cu","cancel","off","React","createElement","className","classnames","AtrcPrefix","id","AtrcControlCodeTextarea","props","_props$value","_props$label","label","_props$onChange","_props$variant","variant","_props$className","_props$notice","notice","CodeTabs","useMemo","title","hasValue","onDeselect","resetAll","tools","activeItems","map","tab","iDx","Fragment","key","indentUnit","tabSize","mode","isDismissible","autoDismiss","status","dangerouslySetInnerHTML","__html","sprintf","__","_default","exports"],"sources":["D:/wamp/www/atrc-package/atrc/packages/molecules/control-code-textarea/index.js"],"sourcesContent":["/*Value Structure\r\nType string\r\n**/\r\n\r\n/*WordPress*/\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\nimport {\r\n\tuseEffect,\r\n\tuseState,\r\n\tuseMemo,\r\n\tuseRef,\r\n\tuseCallback,\r\n\tFragment,\r\n} from '@wordpress/element';\r\n\r\nimport { useInstanceId, debounce } from '@wordpress/compose';\r\n\r\n/*Library*/\r\nimport { map } from 'lodash';\r\n\r\nimport classnames from 'classnames';\r\n\r\nimport deepmerge from 'deepmerge';\r\n\r\n/*Inbuilt*/\r\nimport AtrcWrap from '../../atoms/wrap';\r\n\r\nimport AtrcPanelTools from '../panel-tools';\r\nimport AtrcNotice from '../notice';\r\n\r\n/*Prefix*/\r\nimport AtrcPrefix from '../../prefix-vars';\r\n\r\n/*Local*/\r\nconst CodeEditor = ({ editorValue, onChange, editorSettings }) => {\r\n\tconst [value, setValue] = useState(editorValue);\r\n\tconst [codeMirror, setCodeMirror] = useState(null);\r\n\r\n\tconst instanceId = useInstanceId(CodeEditor, 'atrc-control-code-textarea');\r\n\r\n\tconst debouncedOnChange = useRef(\r\n\t\tdebounce(\r\n\t\t\t(val) => {\r\n\t\t\t\tonChange(val);\r\n\t\t\t},\r\n\t\t\t500,\r\n\t\t\t{ leading: true }\r\n\t\t)\r\n\t);\r\n\r\n\tconst onChangeHandler = useCallback((editor) => {\r\n\t\tconst val = editor.getValue ? editor.getValue() : editor;\r\n\t\tsetValue(val);\r\n\t\tdebouncedOnChange.current(val);\r\n\t}, []);\r\n\r\n\t/*Initialize CodeMirror*/\r\n\tuseEffect(() => {\r\n\t\tif (typeof wp !== 'undefined' && wp.codeEditor) {\r\n\t\t\tconst { defaultSettings, initialize } = wp.codeEditor;\r\n\r\n\t\t\tif (initialize) {\r\n\t\t\t\tconst codeM = initialize(\r\n\t\t\t\t\tinstanceId,\r\n\t\t\t\t\tdeepmerge(defaultSettings, editorSettings)\r\n\t\t\t\t);\r\n\t\t\t\tsetCodeMirror(codeM);\r\n\t\t\t\tcodeM.codemirror.on('change', onChangeHandler);\r\n\t\t\t}\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tdebouncedOnChange?.current?.cancel();\r\n\t\t\t\tcodeMirror?.codemirror.off('change', onChangeHandler);\r\n\t\t\t};\r\n\t\t}\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<textarea\r\n\t\t\tclassName={classnames(AtrcPrefix('control-code-textarea'))}\r\n\t\t\tid={instanceId}\r\n\t\t\tvalue={value}\r\n\t\t\tonChange={onChangeHandler}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nconst AtrcControlCodeTextarea = (props) => {\r\n\tconst {\r\n\t\tvalue = '',\r\n\t\tlabel = '',\r\n\t\tonChange = () => {},\r\n\t\tvariant = '',\r\n\t\tclassName = '',\r\n\t\tnotice = true,\r\n\t} = props;\r\n\r\n\tconst CodeTabs = useMemo(() => {\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tname: 'code',\r\n\t\t\t\ttitle: label,\r\n\t\t\t\thasValue: !!value,\r\n\t\t\t\tonDeselect: () => onChange(''),\r\n\t\t\t},\r\n\t\t];\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<AtrcPanelTools\r\n\t\t\tclassName={classnames(\r\n\t\t\t\tAtrcPrefix('ctrl-code-txt-area'),\r\n\t\t\t\tclassName,\r\n\t\t\t\tvariant ? AtrcPrefix('ctrl-code-txt-area') + '-' + variant : ''\r\n\t\t\t)}\r\n\t\t\tlabel={label}\r\n\t\t\tresetAll={() => onChange('')}\r\n\t\t\ttools={CodeTabs}>\r\n\t\t\t{(activeItems) =>\r\n\t\t\t\tmap(activeItems, (tab, iDx) => (\r\n\t\t\t\t\t<Fragment key={iDx}>\r\n\t\t\t\t\t\t<CodeEditor\r\n\t\t\t\t\t\t\teditorValue={value}\r\n\t\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t\t\teditorSettings={{\r\n\t\t\t\t\t\t\t\tindentUnit: 2,\r\n\t\t\t\t\t\t\t\ttabSize: 2,\r\n\t\t\t\t\t\t\t\tmode: 'css',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{notice && (\r\n\t\t\t\t\t\t\t<AtrcNotice\r\n\t\t\t\t\t\t\t\tisDismissible={false}\r\n\t\t\t\t\t\t\t\tautoDismiss={false}\r\n\t\t\t\t\t\t\t\tstatus='info'>\r\n\t\t\t\t\t\t\t\t<AtrcWrap\r\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\r\n\t\t\t\t\t\t\t\t\t\t__html: sprintf(\r\n\t\t\t\t\t\t\t\t\t\t\t// translators: %1$s: placeholder for code block, %2$s: placeholder for code with {{abBlock}}, %3$s: placeholder for code with ab-unique-class\r\n\t\t\t\t\t\t\t\t\t\t\t__(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'You can use the unique selector of the block using %1$s. eg: %2$s will be replaced with %3$s.',\r\n\t\t\t\t\t\t\t\t\t\t\t\t'atrc-prefix-atrc'\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>{{abBlock}}</code>',\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>{{abBlock}}{color:yellow}</code><br />',\r\n\t\t\t\t\t\t\t\t\t\t\t'<br /><code>.ab-unique-class{color:yellow}</code>'\r\n\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</AtrcNotice>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Fragment>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</AtrcPanelTools>\r\n\t);\r\n};\r\nexport default AtrcControlCodeTextarea;\r\n"],"mappings":"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"}