{"version":3,"names":["store","blockEditorStore","coreStore","__","sprintf","useSelect","getAvatarSizes","sizes","minSize","maxSize","length","maxSizeBuffer","Math","floor","useDefaultAvatar","avatarURL","defaultAvatarUrl","select","getSettings","__experimentalDiscussionSettings","AtrcUseUserAvatar","userId","postId","postType","authorDetails","getEditedEntityRecord","getUser","_authorId","author","avatarUrls","avatar_urls","Object","values","keys","defaultAvatar","src","alt","name"],"sources":["D:/wamp/www/atrc-package/atrc/packages/query/post-author-image/use-user-avatar.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\nfunction getAvatarSizes(sizes) {\r\n\tconst minSize = sizes ? sizes[0] : 24;\r\n\tconst maxSize = sizes ? sizes[sizes.length - 1] : 96;\r\n\tconst maxSizeBuffer = Math.floor(maxSize * 2.5);\r\n\treturn {\r\n\t\tminSize,\r\n\t\tmaxSize: maxSizeBuffer,\r\n\t};\r\n}\r\n\r\nfunction useDefaultAvatar() {\r\n\tconst { avatarURL: defaultAvatarUrl } = useSelect((select) => {\r\n\t\tconst { getSettings } = select(blockEditorStore);\r\n\t\tconst { __experimentalDiscussionSettings } = getSettings();\r\n\t\treturn __experimentalDiscussionSettings;\r\n\t});\r\n\treturn defaultAvatarUrl;\r\n}\r\n\r\nexport default function AtrcUseUserAvatar({ userId, postId, postType }) {\r\n\tconst { authorDetails } = useSelect(\r\n\t\t(select) => {\r\n\t\t\tconst { getEditedEntityRecord, getUser } = select(coreStore);\r\n\t\t\tif (userId) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tauthorDetails: getUser(userId),\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tconst _authorId = getEditedEntityRecord(\r\n\t\t\t\t'postType',\r\n\t\t\t\tpostType,\r\n\t\t\t\tpostId\r\n\t\t\t)?.author;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tauthorDetails: _authorId ? getUser(_authorId) : null,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[postType, postId, userId]\r\n\t);\r\n\tconst avatarUrls = authorDetails?.avatar_urls\r\n\t\t? Object.values(authorDetails.avatar_urls)\r\n\t\t: null;\r\n\tconst sizes = authorDetails?.avatar_urls\r\n\t\t? Object.keys(authorDetails.avatar_urls)\r\n\t\t: null;\r\n\tconst { minSize, maxSize } = getAvatarSizes(sizes);\r\n\tconst defaultAvatar = useDefaultAvatar();\r\n\treturn {\r\n\t\tsrc: avatarUrls ? avatarUrls[avatarUrls.length - 1] : defaultAvatar,\r\n\t\tminSize,\r\n\t\tmaxSize,\r\n\t\talt: authorDetails\r\n\t\t\t? // translators: %s is the Author name.\r\n\t\t\t  sprintf(__('%s Avatar'), authorDetails?.name)\r\n\t\t\t: __('Default Avatar'),\r\n\t};\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,KAAK,IAAIC,gBAAgB,QAAQ,yBAAyB;AACnE,SAASD,KAAK,IAAIE,SAAS,QAAQ,sBAAsB;AACzD,SAASC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;AAC7C,SAASC,SAAS,QAAQ,iBAAiB;AAE3C,SAASC,cAAcA,CAACC,KAAK,EAAE;EAC9B,MAAMC,OAAO,GAAGD,KAAK,GAAGA,KAAK,CAAC,CAAC,CAAC,GAAG,EAAE;EACrC,MAAME,OAAO,GAAGF,KAAK,GAAGA,KAAK,CAACA,KAAK,CAACG,MAAM,GAAG,CAAC,CAAC,GAAG,EAAE;EACpD,MAAMC,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACJ,OAAO,GAAG,GAAG,CAAC;EAC/C,OAAO;IACND,OAAO;IACPC,OAAO,EAAEE;EACV,CAAC;AACF;AAEA,SAASG,gBAAgBA,CAAA,EAAG;EAC3B,MAAM;IAAEC,SAAS,EAAEC;EAAiB,CAAC,GAAGX,SAAS,CAAEY,MAAM,IAAK;IAC7D,MAAM;MAAEC;IAAY,CAAC,GAAGD,MAAM,CAAChB,gBAAgB,CAAC;IAChD,MAAM;MAAEkB;IAAiC,CAAC,GAAGD,WAAW,CAAC,CAAC;IAC1D,OAAOC,gCAAgC;EACxC,CAAC,CAAC;EACF,OAAOH,gBAAgB;AACxB;AAEA,eAAe,SAASI,iBAAiBA,CAAC;EAAEC,MAAM;EAAEC,MAAM;EAAEC;AAAS,CAAC,EAAE;EACvE,MAAM;IAAEC;EAAc,CAAC,GAAGnB,SAAS,CACjCY,MAAM,IAAK;IACX,MAAM;MAAEQ,qBAAqB;MAAEC;IAAQ,CAAC,GAAGT,MAAM,CAACf,SAAS,CAAC;IAC5D,IAAImB,MAAM,EAAE;MACX,OAAO;QACNG,aAAa,EAAEE,OAAO,CAACL,MAAM;MAC9B,CAAC;IACF;IACA,MAAMM,SAAS,GAAGF,qBAAqB,CACtC,UAAU,EACVF,QAAQ,EACRD,MACD,CAAC,EAAEM,MAAM;IAET,OAAO;MACNJ,aAAa,EAAEG,SAAS,GAAGD,OAAO,CAACC,SAAS,CAAC,GAAG;IACjD,CAAC;EACF,CAAC,EACD,CAACJ,QAAQ,EAAED,MAAM,EAAED,MAAM,CAC1B,CAAC;EACD,MAAMQ,UAAU,GAAGL,aAAa,EAAEM,WAAW,GAC1CC,MAAM,CAACC,MAAM,CAACR,aAAa,CAACM,WAAW,CAAC,GACxC,IAAI;EACP,MAAMvB,KAAK,GAAGiB,aAAa,EAAEM,WAAW,GACrCC,MAAM,CAACE,IAAI,CAACT,aAAa,CAACM,WAAW,CAAC,GACtC,IAAI;EACP,MAAM;IAAEtB,OAAO;IAAEC;EAAQ,CAAC,GAAGH,cAAc,CAACC,KAAK,CAAC;EAClD,MAAM2B,aAAa,GAAGpB,gBAAgB,CAAC,CAAC;EACxC,OAAO;IACNqB,GAAG,EAAEN,UAAU,GAAGA,UAAU,CAACA,UAAU,CAACnB,MAAM,GAAG,CAAC,CAAC,GAAGwB,aAAa;IACnE1B,OAAO;IACPC,OAAO;IACP2B,GAAG,EAAEZ,aAAa;IACf;IACApB,OAAO,CAACD,EAAE,CAAC,WAAW,CAAC,EAAEqB,aAAa,EAAEa,IAAI,CAAC,GAC7ClC,EAAE,CAAC,gBAAgB;EACvB,CAAC;AACF"}