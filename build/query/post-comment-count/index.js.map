{"version":3,"names":["__","useEffect","useState","apiFetch","addQueryArgs","AtrcWrap","AtrcNotice","AtrcPostCommentCount","props","postId","htmlTag","defaultProps","_objectWithoutProperties","_excluded","_useState","_useState2","_slicedToArray","commentsCount","setCommentsCount","currentPostId","path","post","parse","then","res","headers","get","hasPostAndComments","undefined","React","createElement","_extends","tag"],"sources":["D:/wamp/www/atrc-package/atrc/packages/query/post-comment-count/index.js"],"sourcesContent":["/*WordPress*/\r\nimport { __ } from '@wordpress/i18n';\r\n\r\nimport { useEffect, useState } from '@wordpress/element';\r\n\r\nimport apiFetch from '@wordpress/api-fetch';\r\n\r\nimport { addQueryArgs } from '@wordpress/url';\r\n\r\n/* Inbuilt */\r\nimport AtrcWrap from '../../atoms/wrap';\r\n\r\nimport AtrcNotice from './../../molecules/notice';\r\n\r\n/* Local */\r\nconst AtrcPostCommentCount = (props) => {\r\n\tconst { postId, htmlTag, ...defaultProps } = props;\r\n\r\n\tconst [commentsCount, setCommentsCount] = useState();\r\n\tuseEffect(() => {\r\n\t\tif (!postId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst currentPostId = postId;\r\n\t\tapiFetch({\r\n\t\t\tpath: addQueryArgs('/wp/v2/comments', {\r\n\t\t\t\tpost: postId,\r\n\t\t\t}),\r\n\t\t\tparse: false,\r\n\t\t}).then((res) => {\r\n\t\t\t// Stale requests will have the `currentPostId` of an older closure.\r\n\t\t\tif (currentPostId === postId) {\r\n\t\t\t\tsetCommentsCount(res.headers.get('X-WP-Total'));\r\n\t\t\t}\r\n\t\t});\r\n\t}, [postId]);\r\n\r\n\tconst hasPostAndComments = postId && commentsCount !== undefined;\r\n\r\n\tif (!hasPostAndComments) {\r\n\t\treturn <AtrcNotice>{__('Post not found.', 'atrc-prefix-atrc')}</AtrcNotice>;\r\n\t}\r\n\treturn (\r\n\t\t<AtrcWrap\r\n\t\t\t{...defaultProps}\r\n\t\t\ttag={htmlTag}>\r\n\t\t\t{commentsCount}\r\n\t\t</AtrcWrap>\r\n\t);\r\n};\r\n\r\nexport default AtrcPostCommentCount;\r\n"],"mappings":";;;;;;;;;;AAAA;AACA,SAASA,EAAE,QAAQ,iBAAiB;AAEpC,SAASC,SAAS,EAAEC,QAAQ,QAAQ,oBAAoB;AAExD,OAAOC,QAAQ,MAAM,sBAAsB;AAE3C,SAASC,YAAY,QAAQ,gBAAgB;;AAE7C;AACA,OAAOC,QAAQ,MAAM,kBAAkB;AAEvC,OAAOC,UAAU,MAAM,0BAA0B;;AAEjD;AACA,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAAIC,KAAK,EAAK;EACvC,IAAQC,MAAM,GAA+BD,KAAK,CAA1CC,MAAM;IAAEC,OAAO,GAAsBF,KAAK,CAAlCE,OAAO;IAAKC,YAAY,GAAAC,wBAAA,CAAKJ,KAAK,EAAAK,SAAA;EAElD,IAAAC,SAAA,GAA0CZ,QAAQ,CAAC,CAAC;IAAAa,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA7CG,aAAa,GAAAF,UAAA;IAAEG,gBAAgB,GAAAH,UAAA;EACtCd,SAAS,CAAC,YAAM;IACf,IAAI,CAACQ,MAAM,EAAE;MACZ;IACD;IACA,IAAMU,aAAa,GAAGV,MAAM;IAC5BN,QAAQ,CAAC;MACRiB,IAAI,EAAEhB,YAAY,CAAC,iBAAiB,EAAE;QACrCiB,IAAI,EAAEZ;MACP,CAAC,CAAC;MACFa,KAAK,EAAE;IACR,CAAC,CAAC,CAACC,IAAI,CAAC,UAACC,GAAG,EAAK;MAChB;MACA,IAAIL,aAAa,KAAKV,MAAM,EAAE;QAC7BS,gBAAgB,CAACM,GAAG,CAACC,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CAAC;MAChD;IACD,CAAC,CAAC;EACH,CAAC,EAAE,CAACjB,MAAM,CAAC,CAAC;EAEZ,IAAMkB,kBAAkB,GAAGlB,MAAM,IAAIQ,aAAa,KAAKW,SAAS;EAEhE,IAAI,CAACD,kBAAkB,EAAE;IACxB,oBAAOE,KAAA,CAAAC,aAAA,CAACxB,UAAU,QAAEN,EAAE,CAAC,iBAAiB,EAAE,kBAAkB,CAAc,CAAC;EAC5E;EACA,oBACC6B,KAAA,CAAAC,aAAA,CAACzB,QAAQ,EAAA0B,QAAA,KACJpB,YAAY;IAChBqB,GAAG,EAAEtB;EAAQ,IACZO,aACQ,CAAC;AAEb,CAAC;AAED,eAAeV,oBAAoB"}