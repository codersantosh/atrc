{"version":3,"names":["useSelect","store","coreStore","EMPTY_ARRAY","AtrcUsePostTerms","postId","taxonomy","showEmpty","showOnlyTopLevel","term","select","getTaxonomy","taxObj","visibility","publicly_queryable","slug","visible","postTerms","isLoading","hasPostTerms","getEntityRecords","isResolving","args","per_page","context","hide_empty","post","parent","taxonomyArgs","terms","length"],"sources":["D:/wamp/www/atrc-package/atrc/packages/query/post-terms/use-post-terms.js"],"sourcesContent":["/*WordPress*/\r\nimport { useSelect } from '@wordpress/data';\r\n\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/* Local */\r\nconst EMPTY_ARRAY = [];\r\n\r\nexport default function AtrcUsePostTerms({\r\n\tpostId,\r\n\ttaxonomy = 'category',\r\n\tshowEmpty = false,\r\n\tshowOnlyTopLevel = false,\r\n}) {\r\n\tconst term = useSelect(\r\n\t\t(select) => {\r\n\t\t\tif (!taxonomy) return {};\r\n\t\t\tconst { getTaxonomy } = select(coreStore);\r\n\t\t\tconst taxObj = getTaxonomy(taxonomy);\r\n\r\n\t\t\treturn taxObj?.visibility?.publicly_queryable ? taxObj : {};\r\n\t\t},\r\n\t\t[taxonomy]\r\n\t);\r\n\r\n\tconst { slug } = term;\r\n\r\n\treturn useSelect(\r\n\t\t(select) => {\r\n\t\t\tconst visible = term?.visibility?.publicly_queryable;\r\n\t\t\tif (!visible) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tpostTerms: EMPTY_ARRAY,\r\n\t\t\t\t\tisLoading: false,\r\n\t\t\t\t\thasPostTerms: false,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tconst { getEntityRecords, isResolving } = select(coreStore);\r\n\t\t\tconst args = {\r\n\t\t\t\tper_page: -1,\r\n\t\t\t\tcontext: 'view',\r\n\t\t\t\thide_empty: !showEmpty,\r\n\t\t\t};\r\n\t\t\tif (postId) {\r\n\t\t\t\targs.post = postId;\r\n\t\t\t}\r\n\t\t\tif (showOnlyTopLevel) {\r\n\t\t\t\targs.parent = 0;\r\n\t\t\t}\r\n\r\n\t\t\tconst taxonomyArgs = ['taxonomy', slug, args];\r\n\t\t\tconst terms = getEntityRecords(...taxonomyArgs);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tpostTerms: terms,\r\n\t\t\t\tisLoading: isResolving('getEntityRecords', taxonomyArgs),\r\n\t\t\t\thasPostTerms: !!terms?.length,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[\r\n\t\t\tpostId,\r\n\t\t\tterm?.visibility?.publicly_queryable,\r\n\t\t\tslug,\r\n\t\t\tshowEmpty,\r\n\t\t\tshowOnlyTopLevel,\r\n\t\t]\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA,SAASA,SAAS,QAAQ,iBAAiB;AAE3C,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;;AAEzD;AACA,MAAMC,WAAW,GAAG,EAAE;AAEtB,eAAe,SAASC,gBAAgBA,CAAC;EACxCC,MAAM;EACNC,QAAQ,GAAG,UAAU;EACrBC,SAAS,GAAG,KAAK;EACjBC,gBAAgB,GAAG;AACpB,CAAC,EAAE;EACF,MAAMC,IAAI,GAAGT,SAAS,CACpBU,MAAM,IAAK;IACX,IAAI,CAACJ,QAAQ,EAAE,OAAO,CAAC,CAAC;IACxB,MAAM;MAAEK;IAAY,CAAC,GAAGD,MAAM,CAACR,SAAS,CAAC;IACzC,MAAMU,MAAM,GAAGD,WAAW,CAACL,QAAQ,CAAC;IAEpC,OAAOM,MAAM,EAAEC,UAAU,EAAEC,kBAAkB,GAAGF,MAAM,GAAG,CAAC,CAAC;EAC5D,CAAC,EACD,CAACN,QAAQ,CACV,CAAC;EAED,MAAM;IAAES;EAAK,CAAC,GAAGN,IAAI;EAErB,OAAOT,SAAS,CACdU,MAAM,IAAK;IACX,MAAMM,OAAO,GAAGP,IAAI,EAAEI,UAAU,EAAEC,kBAAkB;IACpD,IAAI,CAACE,OAAO,EAAE;MACb,OAAO;QACNC,SAAS,EAAEd,WAAW;QACtBe,SAAS,EAAE,KAAK;QAChBC,YAAY,EAAE;MACf,CAAC;IACF;IAEA,MAAM;MAAEC,gBAAgB;MAAEC;IAAY,CAAC,GAAGX,MAAM,CAACR,SAAS,CAAC;IAC3D,MAAMoB,IAAI,GAAG;MACZC,QAAQ,EAAE,CAAC,CAAC;MACZC,OAAO,EAAE,MAAM;MACfC,UAAU,EAAE,CAAClB;IACd,CAAC;IACD,IAAIF,MAAM,EAAE;MACXiB,IAAI,CAACI,IAAI,GAAGrB,MAAM;IACnB;IACA,IAAIG,gBAAgB,EAAE;MACrBc,IAAI,CAACK,MAAM,GAAG,CAAC;IAChB;IAEA,MAAMC,YAAY,GAAG,CAAC,UAAU,EAAEb,IAAI,EAAEO,IAAI,CAAC;IAC7C,MAAMO,KAAK,GAAGT,gBAAgB,CAAC,GAAGQ,YAAY,CAAC;IAE/C,OAAO;MACNX,SAAS,EAAEY,KAAK;MAChBX,SAAS,EAAEG,WAAW,CAAC,kBAAkB,EAAEO,YAAY,CAAC;MACxDT,YAAY,EAAE,CAAC,CAACU,KAAK,EAAEC;IACxB,CAAC;EACF,CAAC,EACD,CACCzB,MAAM,EACNI,IAAI,EAAEI,UAAU,EAAEC,kBAAkB,EACpCC,IAAI,EACJR,SAAS,EACTC,gBAAgB,CAElB,CAAC;AACF"}